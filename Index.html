<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkExpress</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --dark-bg: linear-gradient(45deg, #000000, #1a1a2e, #16213e);
            --dark-card-bg: rgba(16, 20, 35, 0.8);
            --dark-text: #00fff2;
            --dark-border: rgba(0, 255, 242, 0.2);
            --dark-shadow: rgba(0, 255, 242, 0.15);
            --dark-glow: 0 0 25px rgba(0, 255, 242, 0.35);
            
            --light-bg: linear-gradient(45deg, #f0f0f0, #e0e0e0, #d0d0d0);
            --light-card-bg: rgba(255, 255, 255, 0.95);
            --light-text: #ff4d8d;
            --light-border: rgba(255, 77, 141, 0.5);
            --light-shadow: rgba(255, 77, 141, 0.3);

            --matrix-bg: #000000;
            --matrix-card-bg: rgba(0, 20, 0, 0.8);
            --matrix-text: #00ff00;
            --matrix-border: rgba(0, 255, 0, 0.2);
            --matrix-shadow: rgba(0, 255, 0, 0.15);
            --matrix-glow: 0 0 25px rgba(0, 255, 0, 0.35);

            --steampunk-bg: #e0d8c8;
            --steampunk-card-bg: #d4c8b8;
            --steampunk-text: #5c3d2e;
            --steampunk-accent: #b8860b;
            --steampunk-shadow: rgba(92, 61, 46, 0.2);
            --steampunk-border: rgba(184, 134, 11, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--dark-bg);
            color: var(--dark-text);
            min-height: 100vh;
            overflow-x: hidden;
            transition: all 0.5s ease;
        }

        body.light-mode {
            background: var(--light-bg);
            color: var(--light-text);
        }

        body.matrix-mode {
            background: var(--matrix-bg);
            color: var(--matrix-text);
        }

        body.steampunk-mode {
            background: var(--steampunk-bg);
            color: var(--steampunk-text);
        }

        #theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 24px;
            transition: all 0.4s ease;
            background: rgba(255, 255, 255, 0.1);
            color: var(--dark-text);
            backdrop-filter: blur(10px);
            box-shadow: var(--dark-glow), 0 0 0 4px rgba(0, 255, 242, 0.1);
        }

        #theme-toggle:hover {
            transform: rotate(180deg) scale(1.1);
        }

        .light-mode #theme-toggle {
            background: var(--light-card-bg);
            color: var(--light-text);
            box-shadow: 0 0 20px var(--light-shadow), 0 0 0 4px rgba(255, 77, 141, 0.1);
        }

        .matrix-mode #theme-toggle {
            background: var(--matrix-card-bg);
            color: var(--matrix-text);
            box-shadow: var(--matrix-glow), 0 0 0 4px rgba(0, 255, 0, 0.1);
        }

        .steampunk-mode #theme-toggle {
            background: var(--steampunk-card-bg);
            color: var(--steampunk-accent);
            box-shadow: 12px 12px 24px var(--steampunk-shadow), -12px -12px 24px #f0e8d8, inset 5px 5px 10px #c0b8a8, inset -5px -5px 10px #f0e8d8;
            border: 2px solid var(--steampunk-border);
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.6;
        }

        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 50px 20px;
        }

/* Base Title Styles */
.title {
    font-size: 48px;
    font-weight: 700;
    margin-bottom: 40px;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 4px;
    position: relative;
    z-index: 2;
    transition: all 0.3s ease;
}

/* Dark Mode - Futuristic Hologram */
.dark-mode .title {
    color: #00ffff;
    text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 30px #00ffff;
    animation: hologramFlicker 2s infinite;
}

@keyframes hologramFlicker {
    0%, 100% { opacity: 1; transform: scale(1); filter: blur(0px); }
    50% { opacity: 0.8; transform: scale(1.02); filter: blur(1px); }
}

.dark-mode .title::before,
.dark-mode .title::after {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: -1;
}

.dark-mode .title::before {
    color: #ff00ff;
    animation: glitchTop 2s infinite;
}

.dark-mode .title::after {
    color: #00ffff;
    animation: glitchBottom 2.1s infinite;
}

@keyframes glitchTop {
    0%, 100% { clip-path: polygon(0 0, 100% 0, 100% 33%, 0 33%); transform: translate(-0.04em, -0.03em); }
    20% { clip-path: polygon(0 0, 100% 0, 100% 65%, 0 65%); transform: translate(0.05em, 0.06em); }
    40% { clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%); transform: translate(-0.06em, -0.02em); }
    60% { clip-path: polygon(0 0, 100% 0, 100% 86%, 0 86%); transform: translate(0.03em, 0.05em); }
    80% { clip-path: polygon(0 0, 100% 0, 100% 40%, 0 40%); transform: translate(-0.03em, -0.05em); }
}

@keyframes glitchBottom {
    0%, 100% { clip-path: polygon(0 67%, 100% 67%, 100% 100%, 0 100%); transform: translate(0.04em, 0.03em); }
    20% { clip-path: polygon(0 80%, 100% 80%, 100% 100%, 0 100%); transform: translate(-0.05em, -0.06em); }
    40% { clip-path: polygon(0 95%, 100% 95%, 100% 100%, 0 100%); transform: translate(0.06em, 0.02em); }
    60% { clip-path: polygon(0 60%, 100% 60%, 100% 100%, 0 100%); transform: translate(-0.03em, -0.05em); }
    80% { clip-path: polygon(0 85%, 100% 85%, 100% 100%, 0 100%); transform: translate(0.03em, 0.05em); }
}

/* Light Mode - Playful 3D Pop-out */
.light-mode .title {
    color: #ff6b6b;
    text-shadow: 
        2px 2px 0 #fff,
        4px 4px 0 #000;
    transform: rotate(-2deg);
    animation: popOut 0.5s ease-out;
    font-family: 'Bungee', cursive;
}

@keyframes popOut {
    0% { transform: scale(0) rotate(-5deg); }
    80% { transform: scale(1.1) rotate(2deg); }
    100% { transform: scale(1) rotate(-2deg); }
}

.light-mode .title::before,
.light-mode .title::after {
    content: '★';
    position: absolute;
    top: 50%;
    font-size: 36px;
    color: #feca57;
    animation: starTwinkle 1.5s ease-in-out infinite alternate;
}

.light-mode .title::before { left: -50px; transform: translateY(-50%) rotate(-15deg); }
.light-mode .title::after { right: -50px; transform: translateY(-50%) rotate(15deg); }

@keyframes starTwinkle {
    0%, 100% { opacity: 1; transform: translateY(-50%) scale(1) rotate(-15deg); }
    50% { opacity: 0.5; transform: translateY(-50%) scale(0.8) rotate(0deg); }
}

/* Matrix Mode - Improved Glitched Text */
.matrix-mode .title {
    color: #00ff00;
    text-shadow: 2px 2px 0 #003300, -2px -2px 0 #006600;
    font-family: 'Courier New', monospace;
    position: relative;
    letter-spacing: 2px;
}

.matrix-mode .title::before,
.matrix-mode .title::after {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.matrix-mode .title::before {
    left: 2px;
    text-shadow: -1px 0 #00aa00;
    clip-path: inset(10% 0 60% 0);
}

.matrix-mode .title::after {
    left: -2px;
    text-shadow: 1px 0 #00ff00;
    clip-path: inset(60% 0 10% 0);
}

/* Steampunk Mode - Interactive Mechanical */
.steampunk-mode .title {
    color: #8B4513;
    background: linear-gradient(145deg, #e6d5c3, #c2b3a3);
    padding: 20px;
    border-radius: 15px;
    box-shadow: 
        8px 8px 16px #a99d8f,
        -8px -8px 16px #fffbf5, 
        inset 2px 2px 4px #a99d8f,
        inset -2px -2px 4px #fffbf5;
    text-shadow: 2px 2px 4px rgba(92, 61, 46, 0.3);
    border: 2px solid #B8860B;
    position: relative;
    overflow: hidden;
    font-family: 'UnifrakturMaguntia', cursive;
}

.steampunk-mode .title:hover {
    transform: translateY(-5px);
    box-shadow: 
        12px 12px 20px #a99d8f,
        -12px -12px 20px #fffbf5, 
        inset 3px 3px 6px #a99d8f,
        inset -3px -3px 6px #fffbf5;
}

.steampunk-mode .title::before,
.steampunk-mode .title::after {
    content: "";
    position: absolute;
    width: 100px;
    height: 100px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%23B8860B' d='M50 0a50 50 0 100 100A50 50 0 0050 0zm0 8a42 42 0 110 84 42 42 0 010-84zm0 21a21 21 0 100 42 21 21 0 000-42z'/%3E%3C/svg%3E");
    background-size: contain;
    opacity: 0.1;
    z-index: -1;
}

.steampunk-mode .title::before {
    top: -25px;
    left: -25px;
    animation: cogRotate 10s linear infinite;
}

.steampunk-mode .title::after {
    bottom: -25px;
    right: -25px;
    animation: cogRotate 15s linear infinite reverse;
}

@keyframes cogRotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .title {
        font-size: 36px;
        padding: 15px;
    }
    
    .light-mode .title::before,
    .light-mode .title::after {
        font-size: 24px;
    }
    
    .light-mode .title::before { left: -30px; }
    .light-mode .title::after { right: -30px; }
    
    .steampunk-mode .title::before,
    .steampunk-mode .title::after {
        width: 60px;
        height: 60px;
    }
}

        .hub {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px;
            max-width: 1400px;
            width: 100%;
        }

        .app {
            aspect-ratio: 1 / 1;
            background: var(--dark-card-bg);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            backdrop-filter: blur(10px);
            border: 2px solid var(--dark-border);
            box-shadow: 0 8px 32px 0 var(--dark-shadow);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: inherit;
        }

        .app::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent,
                rgba(0, 255, 242, 0.05),
                transparent
            );
            transform: rotate(45deg);
            animation: cyberscan 4s linear infinite;
            transition: all 0.5s ease;
        }

        .app:hover::after {
            opacity: 0.8;
            animation-duration: 2s;
        }

        @keyframes cyberscan {
            0% {
                transform: translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateY(100%) rotate(45deg);
            }
        }

        .light-mode .app {
            background: var(--light-card-bg);
            border: 4px solid var(--light-border);
            box-shadow: 
                8px 8px 0 rgba(255, 77, 141, 0.5),
                16px 16px 0 rgba(255, 77, 141, 0.3);
        }

        .matrix-mode .app {
            background: var(--matrix-card-bg);
            border: 2px solid var(--matrix-border);
            box-shadow: var(--matrix-glow);
        }

        .steampunk-mode .app {
            background: var(--steampunk-card-bg);
            border: none;
            border-radius: 30px;
            box-shadow: 
                20px 20px 60px var(--steampunk-shadow),
                -20px -20px 60px #f0e8d8, 
                inset 10px 10px 20px #c0b8a8,
                inset -10px -10px 20px #f0e8d8;
        }

        .light-mode .app::after,
        .matrix-mode .app::after {
            display: none;
        }

        .steampunk-mode .app::after {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            background: linear-gradient(45deg, #d4c8b8, #e0d8c8);
            border-radius: 25px;
            z-index: -1;
        }

        .app:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 
                0 15px 40px 0 var(--dark-shadow),
                0 0 25px var(--dark-text);
        }

        .light-mode .app:hover {
            transform: translateY(-15px) scale(1.1);
            box-shadow: 
                12px 12px 0 rgba(255, 77, 141, 0.5),
                24px 24px 0 rgba(255, 77, 141, 0.3);
        }

        .matrix-mode .app:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 
                0 15px 40px 0 var(--matrix-shadow),
                0 0 25px var(--matrix-text);
        }

        .steampunk-mode .app:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 
                30px 30px 80px var(--steampunk-shadow),
                -30px -30px 80px #f0e8d8, 
                inset 15px 15px 30px #c0b8a8,
                inset -15px -15px 30px #f0e8d8;
        }

        .app-icon {
            font-size: 64px;
            margin-bottom: 20px;
            transition: all 0.5s ease;
            position: relative;
            z-index: 2;
        }

        .app:hover .app-icon {
            transform: scale(1.2) rotate(360deg);
            text-shadow: 0 0 15px var(--dark-text);
        }

        .light-mode .app:hover .app-icon {
            text-shadow: 0 0 15px var(--light-text);
        }

        .matrix-mode .app:hover .app-icon {
            text-shadow: 0 0 15px var(--matrix-text);
        }

        .steampunk-mode .app:hover .app-icon {
            text-shadow: 2px 2px 4px var(--steampunk-shadow);
            color: var(--steampunk-accent);
        }

        .app-name {
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
        }

        .light-mode .app-name {
            color: var(--light-text);
            font-weight: bold;
            text-shadow: 3px 3px 0 rgba(255, 77, 141, 0.3);
        }

        .matrix-mode .app-name {
            color: var(--matrix-text);
            font-weight: bold;
            text-shadow: 3px 3px 0 rgba(0, 255, 0, 0.3);
        }

        .steampunk-mode .app-name {
            color: var(--steampunk-text);
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(92, 61, 46, 0.3);
        }

        .steampunk-mode .app::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 2px solid var(--steampunk-border);
            border-radius: 20px;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .hub {
                grid-template-columns: repeat(2, 1fr);
                gap: 30px;
            }
        }

        @media (max-width: 480px) {
            .hub {
                grid-template-columns: 1fr;
            }
        }

        /* Enhanced Steampunk Neomorphic Effects */
        .steampunk-mode .app {
            background: 
                linear-gradient(145deg, #e6ddd0, #c2b8a8);
            box-shadow: 
                20px 20px 60px #b1a796,
                -20px -20px 60px #f7ebda,
                inset 5px 5px 10px #c2b8a8,
                inset -5px -5px 10px #e6ddd0;
        }

        .steampunk-mode .app:hover {
            background: 
                linear-gradient(145deg, #c2b8a8, #e6ddd0);
            box-shadow: 
                25px 25px 75px #a19687,
                -25px -25px 75px #fffbe9,
                inset 10px 10px 20px #b1a796,
                inset -10px -10px 20px #f7ebda;
        }

        .steampunk-mode .app-icon {
            color: var(--steampunk-accent);
            text-shadow: 2px 2px 4px rgba(92, 61,46, 0.3);
        }

        .steampunk-mode .app-name {
            background: -webkit-linear-gradient(var(--steampunk-text), var(--steampunk-accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .steampunk-mode #theme-toggle::before {
            content: '⚙️';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 32px;
        }

        .steampunk-mode #theme-toggle:hover::before {
            animation: gear-spin 2s linear infinite;
        }

        @keyframes gear-spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>
</head>
<body>
    <button id="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>
    <canvas id="bg-canvas"></canvas>
    <div class="container">
        <h1 class="title">LinkExpress</h1>
        <div class="hub">
            <a href="https://datakid-github-io.vercel.app/" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-briefcase-medical"></i>
                </div>
                <div class="app-name">خارجي قوي عاملة</div>
            </a>
            <a href="https://datakid2.vercel.app/" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="app-name">خارجي طلاب</div>
            </a>
            <a href="https://desktop-hcufci9xw-datakids-projects.vercel.app/" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-pills"></i>
                </div>
                <div class="app-name">مجموعات دوائية</div>
            </a>
            <a href="https://searchbar-five-beta.vercel.app/" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-search"></i>
                </div>
                <div class="app-name">لستة الادوية</div>
            </a>
            <div class="app" id="dual-link-1">
                <div class="app-icon">
                    <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="app-name">المنفذ والتحمل</div>
            </div>
            <a href="https://protocols-one.vercel.app/" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-folder-open"></i>
                </div>
                <div class="app-name">بروتوكولات التأمين</div>
            </a>
            <a href="https://simpledashboard21.netlify.app/" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="app-name">بيانات الخارجي</div>
            </a>
            <a href="https://celadon-panda-9cbc15.netlify.app//" class="app" target="_blank" rel="noopener noreferrer">
                <div class="app-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="app-name">---</div>
            </a>
        </div>
    </div>

    <script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ 
    canvas: document.getElementById('bg-canvas'), 
    alpha: true,
    antialias: true 
});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);

const darkGeometry = new THREE.TorusKnotGeometry(10, 3, 128, 24);
const lightGeometry = new THREE.DodecahedronGeometry(10, 1);
const matrixGeometry = new THREE.BoxGeometry(10, 10, 10, 10, 10, 10);

const darkMaterial = new THREE.MeshBasicMaterial({ 
    color: 0x00fff2,                     
    wireframe: true,                     
    wireframeLinewidth: 3.0,             
    transparent: true,                   
    opacity: 0.35,                       
    emissive: 0x00fff2,                  
    emissiveIntensity: 0.6,              
    depthWrite: false,                   
    depthTest: true,                     
    side: THREE.DoubleSide,              
    alphaTest: 0.05,                     
    polygonOffset: true,                 
    polygonOffsetFactor: 1.0,            
    polygonOffsetUnits: 1.0,             
    alpha: 0.5                           
});


const lightMaterial = new THREE.MeshBasicMaterial({ 
    color: 0xff4d8d,                     
    wireframe: true,                     
    wireframeLinewidth: 3.0,             
    transparent: true,                   
    opacity: 0.4,                        
    emissive: 0xff4d8d,                  
    emissiveIntensity: 0.5,              
    depthWrite: false,                   
    depthTest: true,                     
    side: THREE.DoubleSide,              
    alphaTest: 0.1,                      
    polygonOffset: true,                 
    polygonOffsetFactor: 1.0,            
    polygonOffsetUnits: 1.0               
});


const matrixMaterial = new THREE.MeshBasicMaterial({ 
    color: 0x00ff00,                     
    wireframe: true,                     
    wireframeLinewidth: 3.0,             
    transparent: true,                   
    opacity: 0.3,                        
    emissive: 0x00ff00,                  
    emissiveIntensity: 0.5,              
    depthWrite: false,                   
    depthTest: true,                     
    side: THREE.DoubleSide,              
    alphaTest: 0.1,                      
    polygonOffset: true,                 
    polygonOffsetFactor: 1.0,            
    polygonOffsetUnits: 1.0               
});


let currentMesh = new THREE.Mesh(darkGeometry, darkMaterial);
scene.add(currentMesh);

camera.position.z = 30;

const themeToggle = document.getElementById('theme-toggle');
const themeIcon = themeToggle.querySelector('i');
let currentTheme = 'dark';

const themes = ['dark', 'light', 'matrix', 'steampunk'];
const themeIcons = {
    'dark': 'fa-moon',
    'light': 'fa-sun',
    'matrix': 'fa-terminal',
    'steampunk': 'fa-cogs'
};

let steampunkObjects = [];

themeToggle.addEventListener('click', () => {
    const currentIndex = themes.indexOf(currentTheme);
    const nextIndex = (currentIndex + 1) % themes.length;
    currentTheme = themes[nextIndex];

    document.body.className = currentTheme !== 'dark' ? `${currentTheme}-mode` : '';
    
    themeIcon.className = `fas ${themeIcons[currentTheme]}`;
    
    while(scene.children.length > 0){ 
        scene.remove(scene.children[0]); 
    }

    switch(currentTheme) {
        case 'light':
            currentMesh = new THREE.Mesh(lightGeometry, lightMaterial);
            scene.add(currentMesh);
            break;
        case 'matrix':
            currentMesh = new THREE.Mesh(matrixGeometry, matrixMaterial);
            scene.add(currentMesh);
            break;
        case 'steampunk':
            createSteampunkScene();
            break;
        default:
            currentMesh = new THREE.Mesh(darkGeometry, darkMaterial);
            scene.add(currentMesh);
    }
});

const dualLink1 = document.getElementById('dual-link-1');
const urls1 = ['https://newlist2.vercel.app/', 'https://newlist-eta.vercel.app/'];

dualLink1.addEventListener('click', () => {
    const randomUrl = urls1[Math.floor(Math.random() * urls1.length)];
    window.open(randomUrl, '_blank');
});

function createMatrixRain() {
    const canvas = document.createElement('canvas');
    canvas.style.position = 'fixed';
    canvas.style.top = '0';
    canvas.style.left = '0';
    canvas.style.zIndex = '-1';
    canvas.style.opacity = '0.3';
    document.body.appendChild(canvas);

    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const katakana = 'アァカサタナハマヤャラワガザダバパイィキシチニヒミリヰギジヂビピウゥクスツヌフムユュルグズブヅプエェケセテネヘメレヱゲゼデベペオォコソトノホモヨョロヲゴゾドボポヴッン';
    const latin = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const nums = '0123456789';
    const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
    const alphabet = katakana + latin + nums + symbols;

    const fontSize = 16;
    const columns = canvas.width / fontSize;

    const rainDrops = [];

    for (let x = 0; x < columns; x++) {
        rainDrops[x] = 1;
    }

    const colors = ['#0F0', '#00FF00', '#32CD32', '#98FB98'];

    function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        for (let i = 0; i < rainDrops.length; i++) {
            const text = alphabet.charAt(Math.floor(Math.random() * alphabet.length));
            ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)];
            ctx.font = `${fontSize}px monospace`;
            ctx.fillText(text, i * fontSize, rainDrops[i] * fontSize);

            if (rainDrops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                rainDrops[i] = 0;
            }
            rainDrops[i]++;
        }

        // Add occasional bright streaks
        if (Math.random() > 0.95) {
            ctx.fillStyle = '#FFFFFF';
            const streakColumn = Math.floor(Math.random() * columns);
            for (let j = 0; j < 5; j++) {
                const streakChar = alphabet.charAt(Math.floor(Math.random() * alphabet.length));
                ctx.fillText(streakChar, streakColumn * fontSize, (rainDrops[streakColumn] + j) * fontSize);
            }
        }
    }

    return setInterval(draw, 30);
}

let matrixInterval;

function toggleMatrixRain() {
    if (currentTheme === 'matrix') {
        matrixInterval = createMatrixRain();
    } else if (matrixInterval) {
        clearInterval(matrixInterval);
        const canvas = document.querySelector('canvas:not(#bg-canvas)');
        if (canvas) {
            canvas.remove();
        }
    }
}

themeToggle.addEventListener('click', toggleMatrixRain);


function createGearShape(outerRadius, innerRadius, teeth, toothDepth) {
    const shape = new THREE.Shape();
    const PI2 = Math.PI * 2;

    shape.moveTo(outerRadius, 0);
    for (let i = 0; i < teeth; i++) {
        const angle = (i / teeth) * PI2;
        const nextAngle = ((i + 1) / teeth) * PI2;

        shape.lineTo(
            Math.cos(angle) * outerRadius,
            Math.sin(angle) * outerRadius
        );
        shape.lineTo(
            Math.cos(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle) * outerRadius,
            Math.sin(nextAngle) * outerRadius
        );
    }
    shape.lineTo(outerRadius, 0);

    const holePath = new THREE.Path();
    holePath.absarc(0, 0, innerRadius, 0, PI2, true);
    shape.holes.push(holePath);

    return shape;
}

function createGearShape(outerRadius, innerRadius, teeth, toothDepth) {
    const shape = new THREE.Shape();
    const PI2 = Math.PI * 2;

    shape.moveTo(outerRadius, 0);
    for (let i = 0; i < teeth; i++) {
        const angle = (i / teeth) * PI2;
        const nextAngle = ((i + 1) / teeth) * PI2;

        shape.lineTo(
            Math.cos(angle) * outerRadius,
            Math.sin(angle) * outerRadius
        );
        shape.lineTo(
            Math.cos(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle) * outerRadius,
            Math.sin(nextAngle) * outerRadius
        );
    }
    shape.lineTo(outerRadius, 0);

    const holePath = new THREE.Path();
    holePath.absarc(0, 0, innerRadius, 0, PI2, true);
    shape.holes.push(holePath);

    return shape;
}

function createGearShape(outerRadius, innerRadius, teeth, toothDepth) {
    const shape = new THREE.Shape();
    const PI2 = Math.PI * 2;

    shape.moveTo(outerRadius, 0);
    for (let i = 0; i < teeth; i++) {
        const angle = (i / teeth) * PI2;
        const nextAngle = ((i + 1) / teeth) * PI2;

        shape.lineTo(
            Math.cos(angle) * outerRadius,
            Math.sin(angle) * outerRadius
        );
        shape.lineTo(
            Math.cos(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle) * outerRadius,
            Math.sin(nextAngle) * outerRadius
        );
    }
    shape.lineTo(outerRadius, 0);

    const holePath = new THREE.Path();
    holePath.absarc(0, 0, innerRadius, 0, PI2, true);
    shape.holes.push(holePath);

    return shape;
}

function createGearShape(outerRadius, innerRadius, teeth, toothDepth) {
    const shape = new THREE.Shape();
    const PI2 = Math.PI * 2;

    shape.moveTo(outerRadius, 0);
    for (let i = 0; i < teeth; i++) {
        const angle = (i / teeth) * PI2;
        const nextAngle = ((i + 1) / teeth) * PI2;

        shape.lineTo(
            Math.cos(angle) * outerRadius,
            Math.sin(angle) * outerRadius
        );
        shape.lineTo(
            Math.cos(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(angle + PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth),
            Math.sin(nextAngle - PI2 / (4 * teeth)) * (outerRadius - toothDepth)
        );
        shape.lineTo(
            Math.cos(nextAngle) * outerRadius,
            Math.sin(nextAngle) * outerRadius
        );
    }
    shape.lineTo(outerRadius, 0);

    const holePath = new THREE.Path();
    holePath.absarc(0, 0, innerRadius, 0, PI2, true);
    shape.holes.push(holePath);

    return shape;
}

function createSteampunkScene() {
    // Adjusted scale factor for better screen fit
    const scaleFactor = 1.5 ;
    
    // Optimized gear configurations with 8 essential gears
    const gearConfigs = [
        // Main center gear (seconds)
        { radius: 5 * scaleFactor, teeth: 60, position: { x: 0, y: 0, z: 0 }, color: 0xb8860b, depth: 2.5 },
        
        // Minutes gear train (2 gears)
        { radius: 3.5 * scaleFactor, teeth: 45, position: { x: 9, y: 0, z: 1.2 }, color: 0xcd853f, depth: 2.2 },
        { radius: 2.8 * scaleFactor, teeth: 30, position: { x: 9, y: 7, z: 1.8 }, color: 0xdaa520, depth: 2.0 },
        
        // Hours gear train (2 gears)
        { radius: 4 * scaleFactor, teeth: 48, position: { x: -8, y: 0, z: 0.8 }, color: 0xd2691e, depth: 2.3 },
        { radius: 3 * scaleFactor, teeth: 36, position: { x: -8, y: 7.5, z: 1.5 }, color: 0x8b4513, depth: 2.1 },
        
        // Escapement mechanism (2 gears)
        { radius: 3.2 * scaleFactor, teeth: 32, position: { x: 0, y: 9, z: 2.0 }, color: 0xffd700, depth: 1.9 },
        { radius: 2.5 * scaleFactor, teeth: 24, position: { x: 4, y: 9, z: 2.4 }, color: 0xb87333, depth: 1.8 },
        
        // Balance wheel (1 gear)
        { radius: 3.8 * scaleFactor, teeth: 40, position: { x: -5, y: -7, z: 1.6 }, color: 0xc0c0c0, depth: 2.4 }
    ];

    const gearMaterial = new THREE.MeshStandardMaterial({ 
        metalness: 0.85,
        roughness: 0.2,
        envMapIntensity: 1.2,
        flatShading: false,
        transparent: true,
        opacity: 0.4
    });

    const gears = [];

    // Create each gear with enhanced 3D depth
    gearConfigs.forEach((config, index) => {
        const gearShape = createGearShape(
            config.radius,
            config.radius * 0.35,
            config.teeth,
            config.radius * 0.2
        );

        const extrudeSettings = {
            depth: config.depth,
            bevelEnabled: true,
            bevelThickness: 0.4,
            bevelSize: 0.3,
            bevelSegments: 8
        };

        const gearGeometry = new THREE.ExtrudeGeometry(gearShape, extrudeSettings);
        const material = gearMaterial.clone();
        material.color.setHex(config.color);
        
        const gear = new THREE.Mesh(gearGeometry, material);
        gear.position.set(
            config.position.x,
            config.position.y,
            config.position.z
        );

        // Enhanced center hub
        const centerHub = new THREE.Mesh(
            new THREE.CylinderGeometry(
                config.radius * 0.3,
                config.radius * 0.3, 
                config.depth + 0.6,
                24
            ),
            new THREE.MeshStandardMaterial({ 
                color: 0x8b4513,
                metalness: 0.95,
                roughness: 0.05
            })
        );
        centerHub.position.z = config.depth/2;
        gear.add(centerHub);

        // Add clock hands to main gear
        if (index === 0) {
            // Hour hand
            const hourHand = new THREE.Mesh(
                new THREE.BoxGeometry(0.4, 4 * scaleFactor, 0.3),
                new THREE.MeshStandardMaterial({ 
                    color: 0x000000,
                    metalness: 0.7,
                    roughness: 0.3
                })
            );
            hourHand.position.z = config.depth + 0.4;
            gear.add(hourHand);
            
            // Minute hand
            const minuteHand = new THREE.Mesh(
                new THREE.BoxGeometry(0.3, 5 * scaleFactor, 0.3),
                new THREE.MeshStandardMaterial({ 
                    color: 0x000000,
                    metalness: 0.7,
                    roughness: 0.3
                })
            );
            minuteHand.position.z = config.depth + 0.8;
            gear.add(minuteHand);
        }

        gears.push(gear);
        scene.add(gear);
        steampunkObjects.push(gear);
    });

    // Create connecting rods between related gears
    function createConnectingRod(start, end) {
        const startPoint = new THREE.Vector3(
            start.position.x,
            start.position.y,
            start.position.z + start.geometry.parameters.depth/2
        );
        const endPoint = new THREE.Vector3(
            end.position.x,
            end.position.y,
            end.position.z + end.geometry.parameters.depth/2
        );
        
        const distance = startPoint.distanceTo(endPoint);
        const rodGeometry = new THREE.CylinderGeometry(
            0.3 * scaleFactor,
            0.3 * scaleFactor, 
            distance, 
            16
        );
        const rodMaterial = new THREE.MeshStandardMaterial({ 
            color: 0x8B4513, 
            metalness: 0.8, 
            roughness: 0.2 
        });
        const rod = new THREE.Mesh(rodGeometry, rodMaterial);
        
        const midpoint = new THREE.Vector3().addVectors(startPoint, endPoint).multiplyScalar(0.5);
        rod.position.copy(midpoint);
        rod.lookAt(endPoint);
        rod.rotateX(Math.PI / 2);
        
        scene.add(rod);
        steampunkObjects.push(rod);
    }

    // Connect related gear pairs
    createConnectingRod(gears[1], gears[2]); // Minutes train
    createConnectingRod(gears[3], gears[4]); // Hours train
    createConnectingRod(gears[5], gears[6]); // Escapement mechanism

    // Animation function
    function animateClock() {
        const baseSpeed = 0.01;
        
        // Main gear (seconds)
        gears[0].rotation.z += baseSpeed;
        
        // Minutes train
        gears[1].rotation.z -= baseSpeed * (gears[0].geometry.parameters.radius / gears[1].geometry.parameters.radius);
        gears[2].rotation.z += baseSpeed * (gears[1].geometry.parameters.radius / gears[2].geometry.parameters.radius);
        
        // Hours train
        gears[3].rotation.z -= baseSpeed * (gears[0].geometry.parameters.radius / gears[3].geometry.parameters.radius);
        gears[4].rotation.z += baseSpeed * (gears[3].geometry.parameters.radius / gears[4].geometry.parameters.radius);
        
        // Escapement
        gears[5].rotation.z -= baseSpeed * 1.5;
        gears[6].rotation.z += baseSpeed * 2;
        
        // Balance wheel
        gears[7].rotation.z = Math.sin(Date.now() * 0.005) * 0.2;
    }

    // Optimized lighting setup
    const mainLight = new THREE.SpotLight(0xffd700, 1.0);
    mainLight.position.set(20, 20, 25);
    mainLight.angle = Math.PI / 3;
    mainLight.penumbra = 0.2;
    mainLight.decay = 1.5;
    mainLight.distance = 100;
    scene.add(mainLight);
    steampunkObjects.push(mainLight);

    const backLight = new THREE.SpotLight(0x6495ed, 0.6);
    backLight.position.set(-15, -15, 15);
    backLight.angle = Math.PI / 4;
    backLight.penumbra = 0.3;
    backLight.decay = 1.5;
    backLight.distance = 100;
    scene.add(backLight);
    steampunkObjects.push(backLight);

    const rimLight = new THREE.SpotLight(0xffffff, 0.4);
    rimLight.position.set(0, 0, 20);
    rimLight.angle = Math.PI / 3;
    rimLight.penumbra = 0.4;
    rimLight.decay = 1.5;
    rimLight.distance = 100;
    scene.add(rimLight);
    steampunkObjects.push(rimLight);

    const ambientLight = new THREE.AmbientLight(0x404040, 0.8);
    scene.add(ambientLight);
    steampunkObjects.push(ambientLight);

    return animateClock;
}

let steampunkAnimate;

function animate() {
    requestAnimationFrame(animate);
    
    if (currentTheme !== 'steampunk') {
        currentMesh.rotation.x += 0.002;
        currentMesh.rotation.y += 0.001;
        
        currentMesh.position.y = Math.sin(Date.now() * 0.001) * 0.8;
        currentMesh.position.x = Math.cos(Date.now() * 0.0005) * 0.5;
    } else if (steampunkAnimate) {
        steampunkAnimate();
    }

    renderer.render(scene, camera);
}
animate();

window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);

    if (currentTheme === 'matrix') {
        clearInterval(matrixInterval);
        matrixInterval = createMatrixRain();
    }
});

themeToggle.addEventListener('click', () => {
    if (currentTheme === 'steampunk') {
        steampunkAnimate = createSteampunkScene();
    } else {
        steampunkAnimate = null;
        // Remove all steampunk objects when switching to other themes
        steampunkObjects.forEach(obj => scene.remove(obj));
        steampunkObjects = [];
    }
});
    </script>
</body>
</html>